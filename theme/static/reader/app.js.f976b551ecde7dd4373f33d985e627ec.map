{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/App.vue?c650","webpack:///./src/App.vue?d061","webpack:///./src/components/TeiReader.vue?913f","webpack:///./src/components/TextReader.vue?4b38","webpack:///./src/util/get.ts","webpack:///./src/util/render.ts","webpack:///./src/components/TextReader.vue","webpack:///./src/components/TextReader.vue?d595","webpack:///./src/components/TextReader.vue?d3a1","webpack:///./src/components/MetadataReader.vue?d2be","webpack:///./src/components/MetadataField.vue?7de8","webpack:///./src/components/MetadataField.vue","webpack:///./src/components/MetadataField.vue?1d8a","webpack:///./src/components/MetadataField.vue?8461","webpack:///./src/components/MetadataReader.vue","webpack:///./src/components/MetadataReader.vue?6b27","webpack:///./src/components/MetadataReader.vue?d550","webpack:///./src/components/NestedListReader.vue?b57b","webpack:///./src/components/NestedListReader.vue","webpack:///./src/components/NestedListReader.vue?9711","webpack:///./src/components/NestedListReader.vue?b449","webpack:///./src/components/TeiReader.vue","webpack:///./src/components/TeiReader.vue?4a5d","webpack:///./src/components/TeiReader.vue?7e96","webpack:///./src/App.vue","webpack:///./src/App.vue?0ab4","webpack:///./src/App.vue?bff9","webpack:///./src/util/XPathEvaluator.ts","webpack:///./src/util/TEIMetadataParser.ts","webpack:///./src/util/TEITextParser.ts","webpack:///./src/util/deepclone.ts","webpack:///./src/store/index.ts","webpack:///./src/main.ts"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","Object","prototype","hasOwnProperty","call","installedChunks","push","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","exports","module","l","m","c","d","name","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","p","jsonpArray","window","oldJsonpFunction","slice","_vm","this","_h","$createElement","_c","_self","class","$store","state","ui","attrs","staticRenderFns","staticClass","smallMenuOpen","isSmall","isSmallMenuOpen","on","toggleSmallMenu","_v","_e","hasMultipleSections","_l","selectedSection","domProps","_s","label","$event","selectSection","closeLabel","closeCallback","close","type","headings","heading","idx","target","activeHeading","navigateTo","sections","section","directives","rawName","expression","text","textClick","hideFootnote","footnote","renderNode","hasSidebarAnnotations","ref","annotationId","annotation","hideAnnotation","obj","path","pathElements","split","Number","parseInt","substring","getNodeSchema","schema","renderHTML","node","textElements","nodeSchema","marks","forEach","mark","entries","reference","external","attr","display","navigation","toLowerCase","content","tmpElements","concat","sectionData","$props","doc","annotations","map","annotationDoc","footnoteDoc","generateHeadings","join","docUpdated","commit","element","document","querySelector","container","$el","scrollTop","offsetTop","ev","scroll","teiReaderSrc","localStorage","getItem","teiReader","JSON","parse","identifier","setItem","stringify","Array","querySelectorAll","filter","getAttribute","article","clientHeight","nextHeading","localName","parentElement","nextTick","child","getText","components","component","group","entry","idx2","config","parent","MetadataField","source","nested","nodeName","docs","lines","id","generateHTML","referencePath","keys","callbacks","TextReader","MetadataReader","NestedListReader","configElement","getElementById","innerHTML","autoLoad","sourceData","dispatch","updateWindowSize","addEventListener","removeEventListener","innerWidth","TeiReader","nsResolver","prefix","dom","xpath","resultType","evaluate","XPathResult","FIRST_ORDERED_NODE_TYPE","singleNodeValue","ORDERED_NODE_ITERATOR_TYPE","STRING_TYPE","stringValue","BOOLEAN_TYPE","booleanValue","NUMBER_TYPE","numberValue","header","firstNode","documentElement","temp","parseHeaderNode","tag","elements","nodeIterator","iterateNext","_attrs","_text","children","attributes","indexOf","multiple","nestedDocs","parser","selector","tmp","parseContentNode","nestedDoc","addNestedDoc","parsers","e","console","log","parseContentAttributes","parseContentMarks","idx3","nestedParent","deepclone","undefined","isArray","val","clone","use","Store","mutations","init","set","TEIReader","setTextDoc","payload","setMetadata","metadata","toggleAnnotation","toggleFootnote","setMode","setDocIdentifier","actions","load","newDoc","domParser","DOMParser","parseFromString","nestedKey","docKey","debounce","productionTip","store","render","h","$mount"],"mappings":"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","file":"js/app.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(Object.prototype.hasOwnProperty.call(installedChunks, chunkId) && installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t\"app\": 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([0,\"chunk-vendors\"]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","export * from \"-!../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=style&index=0&lang=scss&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{class:'mode-' + this.$store.state.ui.mode,attrs:{\"id\":\"app\"}},[_c('TeiReader')],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"tei-reader\"},[_c('div',{class:this.$store.state.ui.smallMenuOpen ? 'small-menu-open' : null},[(_vm.isSmall && _vm.isSmallMenuOpen)?_c('nav',{staticClass:\"main\"},[_c('ul',[_c('li',[_c('a',{on:{\"click\":_vm.toggleSmallMenu}},[_vm._v(\"☰\")])])])]):_vm._e(),((!_vm.isSmall && _vm.hasMultipleSections) || (_vm.isSmall && _vm.isSmallMenuOpen))?_c('nav',{staticClass:\"main\"},[_c('ul',{attrs:{\"role\":\"menubar\"}},[_vm._l((_vm.sections),function(value,key){return _c('li',{key:key,attrs:{\"role\":\"presentation\"}},[_c('a',{attrs:{\"role\":\"menuitem\",\"aria-checked\":key === _vm.selectedSection ? 'true' : 'false'},domProps:{\"innerHTML\":_vm._s(value.label)},on:{\"click\":function($event){return _vm.selectSection(key)}}})])}),(_vm.closeLabel && _vm.closeCallback)?_c('li',{attrs:{\"role\":\"presentation\"}},[_c('a',{attrs:{\"role\":\"menuitem\"},domProps:{\"innerHTML\":_vm._s(_vm.closeLabel)},on:{\"click\":_vm.close}})]):_vm._e()],2)]):_vm._e()]),_vm._l((_vm.sections),function(value,key){return [(key === _vm.selectedSection && value.type === 'Text')?_c('text-reader',{key:key,attrs:{\"section\":key}}):(key === _vm.selectedSection && value.type === 'Metadata')?_c('metadata-reader',{key:key,attrs:{\"section\":key}}):(key === _vm.selectedSection && value.type === 'NestedList')?_c('nested-list-reader',{key:key,attrs:{\"section\":key}}):_vm._e()]})],2)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('main',{staticClass:\"text-reader\"},[(_vm.isSmall && (!_vm.isSmallMenuOpen || _vm.headings.length > 0))?_c('div',{class:_vm.isSmallMenuOpen ? 'small-menu-open' : null},[_c('nav',{staticClass:\"main\"},[_c('ul',[_c('li',[_c('a',{on:{\"click\":_vm.toggleSmallMenu}},[_vm._v(\"☰\")])])])]),(_vm.headings.length > 0)?_c('nav',{staticClass:\"main vertical\"},[_c('ul',[_vm._l((_vm.headings),function(heading,idx){return [(heading.target === _vm.activeHeading || (!_vm.activeHeading && idx === 0) || _vm.isSmallMenuOpen)?_c('li',{key:idx},[_c('a',{attrs:{\"aria-checked\":heading.target === _vm.activeHeading ? 'true' : 'false'},domProps:{\"innerHTML\":_vm._s(heading.label)},on:{\"click\":function($event){_vm.isSmallMenuOpen ? _vm.navigateTo(heading) : _vm.toggleSmallMenu()}}})]):_vm._e()]})],2)]):_c('nav',{staticClass:\"main\"},[_c('ul',[_c('li',[_c('a',{on:{\"click\":_vm.toggleSmallMenu}},[_vm._v(_vm._s(_vm.$store.state.sections[_vm.section].label))])])])])]):_vm._e(),(!_vm.isSmall && _vm.headings.length > 0)?_c('nav',{staticClass:\"headings vertical\"},[_c('ul',_vm._l((_vm.headings),function(heading,idx){return _c('li',{key:idx},[_c('a',{attrs:{\"aria-checked\":heading.target === _vm.activeHeading ? 'true' : 'false'},domProps:{\"innerHTML\":_vm._s(heading.label)},on:{\"click\":function($event){return _vm.navigateTo(heading)}}})])}),0)]):_vm._e(),_c('article',[_c('div',{directives:[{name:\"scroll\",rawName:\"v-scroll\",value:(_vm.scrollReader),expression:\"scrollReader\"}],domProps:{\"innerHTML\":_vm._s(_vm.text)},on:{\"click\":_vm.textClick}}),(_vm.footnote)?_c('aside',[_c('a',{on:{\"click\":function($event){return _vm.hideFootnote(_vm.footnote[0])}}},[_vm._v(\"✖\")]),_c('div',{domProps:{\"innerHTML\":_vm._s(_vm.renderNode(_vm.footnote[1]))},on:{\"click\":_vm.textClick}})]):_vm._e()]),(!_vm.isSmall && _vm.hasSidebarAnnotations)?_c('aside',_vm._l((_vm.annotations),function(ref,idx){\nvar annotationId = ref[0];\nvar annotation = ref[1];\nreturn _c('section',{key:idx},[_c('a',{on:{\"click\":function($event){return _vm.hideAnnotation(annotationId)}}},[_vm._v(\"✖\")]),_c('div',{domProps:{\"innerHTML\":_vm._s(_vm.renderNode(annotation))},on:{\"click\":_vm.textClick}})])}),0):_vm._e()])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","// eslint-disable-next-line\nexport default function get(obj: any, path: string) {\n    let pathElements = path.split('.');\n    while (obj && pathElements.length > 0) {\n        if (pathElements[0][0] === '[' && pathElements[0][pathElements[0].length - 1] === ']') {\n            const idx = Number.parseInt(pathElements[0].substring(1, pathElements[0].length - 1));\n            if (idx >= 0 && idx < obj.length) {\n                obj = obj[idx];\n            }\n        } else {\n            obj = obj[pathElements[0]];\n        }\n        pathElements = pathElements.slice(1);\n    }\n    return obj;\n}\n","import { SerialisedNode } from '@/interfaces';\n\nfunction getNodeSchema(name: string, schema: any) {\n    for (let idx = 0; idx < schema.length; idx++) {\n        if (schema[idx].name === name) {\n            return schema[idx];\n        }\n    }\n    return null;\n}\n\nexport function renderHTML(node: SerialisedNode, schema: any, section: string) {\n    let textElements = [] as string[];\n    if (node) {\n        const nodeSchema = getNodeSchema(node.type, schema);\n        if (nodeSchema) {\n            if (nodeSchema.name === 'text') {\n                if (node.marks) {\n                    textElements.push('<span class=\"');\n                    node.marks.forEach((mark, idx) => {\n                        if (idx > 0) {\n                            textElements.push(' mark-' + mark.type);\n                        } else {\n                            textElements.push('mark-' + mark.type);\n                        }\n                    });\n                    textElements.push('\"');\n                    node.marks.forEach((mark) => {\n                        if (mark.attrs) {\n                            Object.entries(mark.attrs).forEach(([key, value]) => {\n                                textElements.push(' data-' + key + '=\"' + value + '\"');\n                            });\n                        }\n                    });\n                    textElements.push('>');\n                }\n            } else if (nodeSchema.reference) {\n                textElements.push('<a class=\"node-' + node.type + '\"');\n                if (node.attrs) {\n                    Object.entries(node.attrs).forEach(([key, value]) => {\n                        textElements.push(' data-' + key + '=\"' + value + '\"');\n                    });\n                }\n                if (node.attrs && nodeSchema.reference && nodeSchema.reference.external && node.attrs[nodeSchema.reference.external]) {\n                    textElements.push(' href=\"' + node.attrs[nodeSchema.reference.external] + '\" target=\"_blank\"');\n                }\n                if (node.attrs && nodeSchema.reference && nodeSchema.reference.attr && node.attrs[nodeSchema.reference.attr]) {\n                    textElements.push(' data-reference-path=\"' + section + '.nested.' + nodeSchema.reference.type + '.' + node.attrs[nodeSchema.reference.attr] + '\"');\n                    textElements.push(' data-reference-mode=\"' + nodeSchema.reference.display + '\"');\n                }\n                textElements.push('>');\n            } else if (nodeSchema.type === 'inline') {\n                textElements.push('<span class=\"node-' + node.type + '\"');\n                if (node.attrs) {\n                    Object.entries(node.attrs).forEach(([key, value]) => {\n                        textElements.push(' data-' + key + '=\"' + value + '\"');\n                    });\n                }\n                textElements.push('>');\n            } else {\n                textElements.push('<div class=\"node-' + node.type + '\"');\n                if (node.attrs) {\n                    Object.entries(node.attrs).forEach(([key, value]) => {\n                        textElements.push(' data-' + key + '=\"' + value + '\"');\n                    });\n                }\n                if (nodeSchema.navigation) {\n                    textElements.push(' data-navigation-attr=\"' + nodeSchema.navigation.attr.toLowerCase() + '\"');\n                }\n                textElements.push('>');\n            }\n            if (node.text) {\n                textElements.push(node.text);\n            }\n            if (node.content) {\n                for (let idx = 0; idx < node.content.length; idx++) {\n                    const tmpElements = renderHTML(node.content[idx], schema, section);\n                    textElements = textElements.concat(tmpElements);\n                }\n            }\n            if (nodeSchema.name === 'text') {\n                if (node.marks) {\n                    textElements.push('</span>');\n                }\n            } else if (nodeSchema.reference) {\n                textElements.push('</a>');\n            } else if (nodeSchema.type === 'inline') {\n                textElements.push('</span>');\n            } else {\n                textElements.push('</div>');\n            }\n        } else if (node.type === 'doc') {\n            if (node.content) {\n                for (let idx = 0; idx < node.content.length; idx++) {\n                    const tmpElements = renderHTML(node.content[idx], schema, section);\n                    textElements = textElements.concat(tmpElements);\n                }\n            }\n        }\n    }\n    return textElements;\n}\n","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport { Component, Prop, Vue, Watch } from 'vue-property-decorator';\n// eslint-disable-next-line\n// @ts-ignore\nimport { tween } from 'femtotween';\n\nimport get from '@/util/get';\nimport { StringKeyValueDict, NumberKeyValueDict, SerialisedNode, AnyKeyValueDict } from '@/interfaces';\nimport { renderHTML } from '@/util/render';\n\n@Component({\n    components: {\n    },\n})\nexport default class TextReader extends Vue {\n    @Prop() section!: string;\n\n    activeHeading: string | null = '';\n\n    // ===================\n    // Computed properties\n    // ===================\n    public get isSmall() {\n        return this.$store.state.ui.mode === 'small';\n    }\n\n    public get isSmallMenuOpen() {\n        return this.$store.state.ui.smallMenuOpen;\n    }\n\n    public get doc() {\n        const sectionData = this.$store.state.content[this.$props.section];\n        if (sectionData && sectionData.doc) {\n            return sectionData.doc;\n        } else {\n            return null;\n        }\n    }\n\n    public get hasSidebarAnnotations(): boolean {\n        const schema = this.$store.state.sections[this.$props.section].schema;\n        for (let idx = 0; idx < schema.length; idx++) {\n            if (schema[idx].reference && schema[idx].reference.display === 'sidebar') {\n                return true;\n            }\n        }\n        return false;\n    }\n\n    public get annotations() {\n        return this.$store.state.ui.sections[this.$props.section].annotations.map((annotation: string) => {\n            const annotationDoc = get(this.$store.state.content, annotation);\n            if (annotationDoc) {\n                return [annotation, annotationDoc.content[0]];\n            } else {\n                return null;\n            }\n        });\n    }\n\n    public get footnote() {\n        const footnote = this.$store.state.ui.sections[this.$props.section].footnote;\n        if (footnote) {\n            const footnoteDoc = get(this.$store.state.content, footnote);\n            if (footnoteDoc) {\n                return [footnote, footnoteDoc.content[0]];\n            }\n        }\n        return null;\n    }\n\n    public get headings() {\n        if (this.doc) {\n            const schema = this.$store.state.sections[this.$props.section].schema;\n            const headings = [] as StringKeyValueDict[];\n            this.generateHeadings(this.doc, schema, headings)\n            return headings;\n        }\n        return [];\n    }\n\n    public get schema() {\n        return this.$store.state.sections[this.$props.section].schema;\n    }\n\n    public get text() {\n        return renderHTML(this.doc, this.schema, this.$props.section).join('');\n    }\n\n    public renderNode(node: SerialisedNode) {\n        return renderHTML(node, this.schema, this.$props.section).join('');\n    }\n\n    // ==================\n    // Lifecycle handlers\n    // ==================\n\n    public mounted() {\n        this.docUpdated();\n    }\n\n    // ==============\n    // Event handlers\n    // ==============\n\n    public hideAnnotation(annotation: string) {\n        this.$store.commit('toggleAnnotation', { path: annotation });\n    }\n\n    public hideFootnote(annotation: string) {\n        this.$store.commit('toggleFootnote', { path: annotation });\n    }\n\n    public navigateTo(heading: StringKeyValueDict) {\n        const element = document.querySelector('[data-' + heading.attr + '=\"' + heading.target + '\"]') as HTMLElement;\n        if (element) {\n            const container = this.$el.querySelector('article > div') as HTMLElement;\n            if (container) {\n                tween(container.scrollTop, element.offsetTop, (value: number) => { container.scrollTop = value; });\n            }\n        }\n        if (this.isSmallMenuOpen) {\n            this.toggleSmallMenu();\n        }\n    }\n\n    public toggleSmallMenu() {\n        this.$store.commit('toggleSmallMenu');\n    }\n\n    public scrollReader(ev: UIEvent, scroll: NumberKeyValueDict) {\n        if (this && this.$el) {\n            // Store scroll\n            const teiReaderSrc = window.localStorage.getItem('tei-reader');\n            let teiReader = {} as AnyKeyValueDict;\n            if (teiReaderSrc) {\n                teiReader = JSON.parse(teiReaderSrc);\n            }\n            if (!teiReader[this.$store.state.ui.identifier]) {\n                teiReader[this.$store.state.ui.identifier] = {};\n            }\n            if (!teiReader[this.$store.state.ui.identifier][this.$props.section]) {\n                teiReader[this.$store.state.ui.identifier][this.$props.section] = 0;\n            }\n            teiReader[this.$store.state.ui.identifier][this.$props.section] = scroll.scrollTop;\n            window.localStorage.setItem('tei-reader', JSON.stringify(teiReader));\n            // Update Headings\n            const headings = Array.prototype.slice.call(this.$el.querySelectorAll('[data-navigation-attr]')).filter((heading: HTMLElement) => {\n                return heading.getAttribute('data-' + heading.getAttribute('data-navigation-attr'));\n            });\n            if (headings.length > 0) {\n                this.activeHeading = null;\n                if (scroll.scrollTop > 0) {\n                    const article = this.$el.querySelector('article');\n                    if (article) {\n                        scroll.scrollTop = scroll.scrollTop + article.clientHeight * 0.25;\n                    }\n                }\n                for (let idx = 0; idx < headings.length; idx++) {\n                    const heading = headings[idx] as HTMLElement;\n                    if (idx < headings.length - 1) {\n                        const nextHeading = headings[idx + 1] as HTMLElement;\n                        if (scroll.scrollTop >= heading.offsetTop && scroll.scrollTop < nextHeading.offsetTop) {\n                            this.activeHeading = heading.getAttribute('data-' + heading.getAttribute('data-navigation-attr'));\n                        }\n                    } else {\n                        if (scroll.scrollTop >= heading.offsetTop) {\n                            this.activeHeading = heading.getAttribute('data-' + heading.getAttribute('data-navigation-attr'));\n                        }\n                    }\n                }\n            }\n        }\n    }\n\n    public textClick(ev: MouseEvent) {\n        let target = ev.target as HTMLElement;\n        while (target) {\n            if (target.localName === 'a') {\n                break;\n            }\n            target = target.parentElement as HTMLElement;\n        }\n        if (target && target.getAttribute('data-reference-path')) {\n            if (target.getAttribute('data-reference-mode') === 'sidebar') {\n                if (this.$store.state.ui.mode === 'small') {\n                    this.$store.commit('toggleFootnote', { path: target.getAttribute('data-reference-path') });\n                } else {\n                    this.$store.commit('toggleAnnotation', { path: target.getAttribute('data-reference-path') });\n                }\n            } else if (target.getAttribute('data-reference-mode') === 'footnote') {\n                this.$store.commit('toggleFootnote', { path: target.getAttribute('data-reference-path') });\n            }\n        }\n    }\n\n    // =======\n    // Watches\n    // =======\n\n    @Watch('doc')\n    public docUpdated() {\n        const container = this.$el.querySelector('article > div') as HTMLElement;\n        container.scrollTop = 0;\n        if (window.localStorage && this.$store.state.ui.identifier && this.$props.section) {\n            const teiReaderSrc = window.localStorage.getItem('tei-reader');\n            let teiReader = {} as AnyKeyValueDict;\n            if (teiReaderSrc) {\n                teiReader = JSON.parse(teiReaderSrc);\n            }\n            if (!teiReader[this.$store.state.ui.identifier]) {\n                teiReader[this.$store.state.ui.identifier] = {};\n            }\n            if (!teiReader[this.$store.state.ui.identifier][this.$props.section]) {\n                teiReader[this.$store.state.ui.identifier][this.$props.section] = 0;\n            }\n            const container = this.$el.querySelector('article > div') as HTMLElement;\n            Vue.nextTick(() => {\n                container.scrollTop = teiReader[this.$store.state.ui.identifier][this.$props.section];\n            });\n            window.localStorage.setItem('tei-reader', JSON.stringify(teiReader));\n        }\n    }\n\n    // ===============\n    // Private methods\n    // ===============\n\n    private getText(node: SerialisedNode): string {\n        if (node.type === 'text' && node.text) {\n            return node.text;\n        } else {\n            if (node.content) {\n                return node.content.map((child) => { return this.getText(child); }).join('');\n            } else {\n                return '';\n            }\n        }\n    }\n\n    private generateHeadings(node: SerialisedNode, schema: any, headings: StringKeyValueDict[]) {\n        if (node) {\n            for (let idx = 0; idx < schema.length; idx++) {\n                if (schema[idx].name === node.type && schema[idx].navigation && node.attrs && node.attrs[schema[idx].navigation.attr]) {\n                    headings.push({\n                        attr: schema[idx].navigation.attr,\n                        target: node.attrs[schema[idx].navigation.attr] as string,\n                        label: this.getText(node),\n                    });\n                }\n            }\n            if (node.content) {\n                for (let idx = 0; idx < node.content.length; idx++) {\n                    this.generateHeadings(node.content[idx], schema, headings)\n                }\n            }\n        }\n    }\n}\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TextReader.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TextReader.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./TextReader.vue?vue&type=template&id=5af38bdc&\"\nimport script from \"./TextReader.vue?vue&type=script&lang=ts&\"\nexport * from \"./TextReader.vue?vue&type=script&lang=ts&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('main',{staticClass:\"metadata-reader\"},[(_vm.isSmall && !_vm.isSmallMenuOpen)?_c('div',{class:_vm.isSmallMenuOpen ? 'small-menu-open' : null},[_c('nav',[_c('ul',[_c('li',[_c('a',{on:{\"click\":_vm.toggleSmallMenu}},[_vm._v(\"☰\")])])])]),_c('nav',{staticClass:\"vertical\"},[_c('ul',[_c('li',[_c('a',{on:{\"click\":_vm.toggleSmallMenu}},[_vm._v(_vm._s(_vm.$store.state.sections[_vm.section].label))])])])])]):_vm._e(),_vm._l((_vm.metadataGroups),function(group,idx){return _c('section',{key:idx},[_c('h2',[_vm._v(_vm._s(group.label))]),_vm._l((group.entries),function(entry,idx2){return _c('metadata-field',{key:idx2,attrs:{\"section\":_vm.section,\"config\":entry,\"parent\":''}})})],2)})],2)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[(_vm.config.type == 'single-text')?[_c('span',{staticClass:\"field\"},[_c('span',{staticClass:\"label\"},[_vm._v(_vm._s(_vm.config.label))]),_c('span',{staticClass:\"value\"},[_vm._v(_vm._s(_vm.value))])])]:_vm._e(),(_vm.config.type == 'multi-row')?[_c('ol',{staticClass:\"multi-row\"},_vm._l((_vm.value),function(data,idx){return _c('li',{key:idx},_vm._l((_vm.config.entries),function(entry,idx2){return _c('metadata-field',{key:idx2,attrs:{\"section\":_vm.section,\"config\":entry,\"parent\":_vm.parent + _vm.config.path + '.[' + idx + ']'}})}),1)}),0)]:_vm._e(),(_vm.config.type == 'multi-field')?[_c('ol',{staticClass:\"multi-field\"},_vm._l((_vm.config.entries),function(entry,idx){return _c('li',{key:idx},[_c('metadata-field',{attrs:{\"section\":_vm.section,\"config\":entry,\"parent\":_vm.parent + _vm.config.path}})],1)}),0)]:_vm._e()],2)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport { Component, Prop, Vue } from 'vue-property-decorator';\nimport get from '@/util/get';\nimport { ConfigMetadataNodeSchema } from '@/interfaces';\n\n@Component({\n    name: 'metadata-field',\n})\nexport default class MetadataField extends Vue {\n    @Prop() config!: ConfigMetadataNodeSchema;\n    @Prop() section!: string;\n    @Prop() parent!: string;\n\n    public get value() {\n        const value = get(this.$store.state.content[this.$props.section], this.$props.parent + this.$props.config.path);\n        if (value) {\n            return value;\n        } else {\n            return '';\n        }\n    }\n}\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./MetadataField.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./MetadataField.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./MetadataField.vue?vue&type=template&id=05127f29&\"\nimport script from \"./MetadataField.vue?vue&type=script&lang=ts&\"\nexport * from \"./MetadataField.vue?vue&type=script&lang=ts&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport { Component, Prop, Vue } from 'vue-property-decorator';\nimport MetadataField from './MetadataField.vue';\n\n@Component({\n    components: {\n        MetadataField,\n    },\n})\nexport default class MetadataReader extends Vue {\n    @Prop() section!: string;\n\n    // ===================\n    // Computed properties\n    // ===================\n    public get isSmall() {\n        return this.$store.state.ui.mode === 'small';\n    }\n\n    public get isSmallMenuOpen() {\n        return this.$store.state.ui.smallMenuOpen;\n    }\n\n    public get metadataGroups() {\n        return this.$store.state.sections[this.$props.section].ui;\n    }\n\n    // ==============\n    // Event handlers\n    // ==============\n\n    public toggleSmallMenu() {\n        this.$store.commit('toggleSmallMenu');\n    }\n}\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./MetadataReader.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./MetadataReader.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./MetadataReader.vue?vue&type=template&id=63c695fe&\"\nimport script from \"./MetadataReader.vue?vue&type=script&lang=ts&\"\nexport * from \"./MetadataReader.vue?vue&type=script&lang=ts&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('main',{staticClass:\"nested-list-reader\"},[(_vm.isSmall && !_vm.isSmallMenuOpen)?_c('div',{class:_vm.isSmallMenuOpen ? 'small-menu-open' : null},[_c('nav',{staticClass:\"main\"},[_c('ul',[_c('li',[_c('a',{on:{\"click\":_vm.toggleSmallMenu}},[_vm._v(\"☰\")])])])]),_c('nav',{staticClass:\"main vertical\"},[_c('ul',[_c('li',[_c('a',{on:{\"click\":_vm.toggleSmallMenu}},[_vm._v(_vm._s(_vm.$store.state.sections[_vm.section].label))])])])])]):_vm._e(),_c('article',[_c('div',{directives:[{name:\"scroll\",rawName:\"v-scroll\",value:(_vm.scrollReader),expression:\"scrollReader\"}],domProps:{\"innerHTML\":_vm._s(_vm.text)},on:{\"click\":_vm.textClick}})])])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport { Component, Prop, Vue, Watch } from 'vue-property-decorator';\nimport { NumberKeyValueDict, SerialisedNode, AnyKeyValueDict } from '@/interfaces';\n// eslint-disable-next-line\n// @ts-ignore\nimport { tween } from 'femtotween';\n\n@Component({\n    components: {\n    },\n})\nexport default class NestedListReader extends Vue {\n    @Prop() section!: string;\n\n    activeHeading: string | null = '';\n\n    // ===================\n    // Computed properties\n    // ===================\n    public get isSmall() {\n        return this.$store.state.ui.mode === 'small';\n    }\n\n    public get isSmallMenuOpen() {\n        return this.$store.state.ui.smallMenuOpen;\n    }\n\n    public get sectionData() {\n        return this.$store.state.sections[this.$props.section];\n    }\n\n    public get docs(): {[x: string]: SerialisedNode} | null {\n        const sectionData = this.$store.state.content[this.sectionData.source];\n        if (sectionData && sectionData.nested && sectionData.nested[this.sectionData.nodeName]) {\n            return sectionData.nested[this.sectionData.nodeName];\n        } else {\n            return null;\n        }\n    }\n\n    public get schema() {\n        return this.$store.state.sections[this.sectionData.source].schema;\n    }\n\n    public get text() {\n        if (this.docs) {\n            let lines = ['<ol>'];\n            Object.entries(this.docs).forEach(([id, node]) => {\n                if (node.content && node.content.length > 0) {\n                    lines.push('<li id=\"' + id + '\">');\n                    lines = lines.concat(this.generateHTML(node.content[0], this.schema));\n                    lines.push('</li>');\n                }\n            });\n            lines.push('</ol>');\n            return lines.join('');\n        } else {\n            return null;\n        }\n    }\n\n    // ==================\n    // Lifecycle handlers\n    // ==================\n\n    public mounted() {\n        this.docUpdated();\n    }\n\n    // ==============\n    // Event handlers\n    // ==============\n\n    public toggleSmallMenu() {\n        this.$store.commit('toggleSmallMenu');\n    }\n\n    public scrollReader(ev: UIEvent, scroll: NumberKeyValueDict) {\n        if (this && this.$el) {\n            const teiReaderSrc = window.localStorage.getItem('tei-reader');\n            let teiReader = {} as AnyKeyValueDict;\n            if (teiReaderSrc) {\n                teiReader = JSON.parse(teiReaderSrc);\n            }\n            if (!teiReader[this.$store.state.ui.identifier]) {\n                teiReader[this.$store.state.ui.identifier] = {};\n            }\n            if (!teiReader[this.$store.state.ui.identifier][this.$props.section]) {\n                teiReader[this.$store.state.ui.identifier][this.$props.section] = 0;\n            }\n            teiReader[this.$store.state.ui.identifier][this.$props.section] = scroll.scrollTop;\n            window.localStorage.setItem('tei-reader', JSON.stringify(teiReader));\n        }\n    }\n\n    public textClick(ev: MouseEvent) {\n        let target = ev.target as HTMLElement;\n        while (target) {\n            if (target.localName === 'a') {\n                break;\n            }\n            target = target.parentElement as HTMLElement;\n        }\n        const referencePath = target.getAttribute('data-reference-path');\n        if (target && referencePath) {\n            const path = referencePath.split('.');\n            if (path.length > 0 && path[0] === this.sectionData.source && path[2] == this.sectionData.nodeName) {\n                const container = this.$el.querySelector('article > div') as HTMLElement;\n                const element = this.$el.querySelector('#' + path[3]) as HTMLElement;\n                if (container && element) {\n                    tween(container.scrollTop, element.offsetTop, (value: number) => { container.scrollTop = value; });\n                }\n            }\n        }\n    }\n\n    // =======\n    // Watches\n    // =======\n\n    @Watch('doc')\n    public docUpdated() {\n        const container = this.$el.querySelector('article > div') as HTMLElement;\n        container.scrollTop = 0;\n        if (window.localStorage && this.$store.state.ui.identifier && this.$props.section) {\n            const teiReaderSrc = window.localStorage.getItem('tei-reader');\n            let teiReader = {} as AnyKeyValueDict;\n            if (teiReaderSrc) {\n                teiReader = JSON.parse(teiReaderSrc);\n            }\n            if (!teiReader[this.$store.state.ui.identifier]) {\n                teiReader[this.$store.state.ui.identifier] = {};\n            }\n            if (!teiReader[this.$store.state.ui.identifier][this.$props.section]) {\n                teiReader[this.$store.state.ui.identifier][this.$props.section] = 0;\n            }\n            const container = this.$el.querySelector('article > div') as HTMLElement;\n            Vue.nextTick(() => {\n                container.scrollTop = teiReader[this.$store.state.ui.identifier][this.$props.section];\n            });\n            window.localStorage.setItem('tei-reader', JSON.stringify(teiReader));\n        }\n    }\n\n    // ===============\n    // Private methods\n    // ===============\n\n    private nodeSchema(name: string, schema: any) {\n        for (let idx = 0; idx < schema.length; idx++) {\n            if (schema[idx].name === name) {\n                return schema[idx];\n            }\n        }\n        return null;\n    }\n\n    private getText(node: SerialisedNode): string {\n        if (node.type === 'text' && node.text) {\n            return node.text;\n        } else {\n            if (node.content) {\n                return node.content.map((child) => { return this.getText(child); }).join('');\n            } else {\n                return '';\n            }\n        }\n    }\n\n    private generateHTML(node: SerialisedNode, schema: any) {\n        let textElements = [] as string[];\n        if (node) {\n            const nodeSchema = this.nodeSchema(node.type, schema);\n            if (nodeSchema) {\n                if (nodeSchema.name === 'text') {\n                    if (node.marks) {\n                        textElements.push('<span class=\"');\n                        node.marks.forEach((mark, idx) => {\n                            if (idx > 0) {\n                                textElements.push(' mark-' + mark.type);\n                            } else {\n                                textElements.push('mark-' + mark.type);\n                            }\n                        });\n                        textElements.push('\"');\n                        node.marks.forEach((mark) => {\n                            if (mark.attrs) {\n                                Object.entries(mark.attrs).forEach(([key, value]) => {\n                                    textElements.push(' data-' + key + '=\"' + value + '\"');\n                                });\n                            }\n                        });\n                        textElements.push('>');\n                    }\n                } else if (nodeSchema.reference) {\n                    textElements.push('<a class=\"node-' + node.type + '\"');\n                    if (node.attrs) {\n                        Object.entries(node.attrs).forEach(([key, value]) => {\n                            textElements.push(' data-' + key + '=\"' + value + '\"');\n                        });\n                    }\n                    if (node.attrs && nodeSchema.reference && nodeSchema.reference.attr && node.attrs[nodeSchema.reference.attr]) {\n                        textElements.push(' data-reference-path=\"' + this.$props.section + '.nested.' + nodeSchema.reference.type + '.' + (node.attrs[nodeSchema.reference.attr] as string).substring(1) + '\"');\n                        textElements.push(' data-reference-mode=\"' + nodeSchema.reference.display + '\"');\n                    }\n                    textElements.push('>');\n                } else if (nodeSchema.type === 'inline') {\n                    textElements.push('<span class=\"node-' + node.type + '\"');\n                    if (node.attrs) {\n                        Object.entries(node.attrs).forEach(([key, value]) => {\n                            textElements.push(' data-' + key + '=\"' + value + '\"');\n                        });\n                    }\n                    textElements.push('>');\n                } else {\n                    textElements.push('<div class=\"node-' + node.type + '\"');\n                    if (node.attrs) {\n                        Object.entries(node.attrs).forEach(([key, value]) => {\n                            textElements.push(' data-' + key + '=\"' + value + '\"');\n                        });\n                    }\n                    textElements.push('>');\n                }\n                if (node.text) {\n                    textElements.push(node.text);\n                }\n                if (node.content) {\n                    for (let idx = 0; idx < node.content.length; idx++) {\n                        const tmpElements = this.generateHTML(node.content[idx], schema);\n                        textElements = textElements.concat(tmpElements);\n                    }\n                }\n                if (nodeSchema.name === 'text') {\n                    if (node.marks) {\n                        textElements.push('</span>');\n                    }\n                } else if (nodeSchema.reference) {\n                    textElements.push('</a>');\n                } else if (nodeSchema.type === 'inline') {\n                    textElements.push('</span>');\n                } else {\n                    textElements.push('</div>');\n                }\n            } else if (node.type === 'doc') {\n                if (node.content) {\n                    for (let idx = 0; idx < node.content.length; idx++) {\n                        const tmpElements = this.generateHTML(node.content[idx], schema);\n                        textElements = textElements.concat(tmpElements);\n                    }\n                }\n            }\n        }\n        return textElements;\n    }\n}\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./NestedListReader.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./NestedListReader.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./NestedListReader.vue?vue&type=template&id=11fbad36&\"\nimport script from \"./NestedListReader.vue?vue&type=script&lang=ts&\"\nexport * from \"./NestedListReader.vue?vue&type=script&lang=ts&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport { Component, Vue } from 'vue-property-decorator';\nimport TextReader from './TextReader.vue';\nimport MetadataReader from './MetadataReader.vue';\nimport NestedListReader from './NestedListReader.vue';\n\n@Component({\n    components: {\n        TextReader,\n        MetadataReader,\n        NestedListReader,\n    },\n})\nexport default class TeiReader extends Vue {\n    public get isSmall() {\n        return this.$store.state.ui.mode === 'small';\n    }\n\n    public get isSmallMenuOpen() {\n        return this.$store.state.ui.smallMenuOpen;\n    }\n\n    public get hasMultipleSections() {\n        return Object.keys(this.$store.state.sections).length > 1;\n    }\n\n    public get sections() {\n        return this.$store.state.sections;\n    }\n\n    public get selectedSection() {\n        return this.$store.state.ui.selectedSection;\n    }\n\n\n    public get closeLabel() {\n        return this.$store.state.ui.closeLabel;\n    }\n\n    public get closeCallback() {\n        return this.$store.state.callbacks.close;\n    }\n\n    public selectSection(key: string) {\n        this.$store.commit('selectSection', key);\n        if (this.isSmall) {\n            this.$store.commit('toggleSmallMenu');\n        }\n    }\n\n    public toggleSmallMenu() {\n        this.$store.commit('toggleSmallMenu');\n    }\n\n    public close() {\n        if (this.isSmall) {\n            this.$store.commit('toggleSmallMenu');\n        }\n        this.closeCallback();\n    }\n}\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TeiReader.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TeiReader.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./TeiReader.vue?vue&type=template&id=bdcf7bf6&\"\nimport script from \"./TeiReader.vue?vue&type=script&lang=ts&\"\nexport * from \"./TeiReader.vue?vue&type=script&lang=ts&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","\n\n\n\n\n\n\nimport { Component, Vue } from 'vue-property-decorator';\nimport TeiReader from './components/TeiReader.vue';\n\n@Component({\n  components: {\n    TeiReader,\n  },\n})\nexport default class App extends Vue {\n    public mounted() {\n        const configElement = document.getElementById('TEIReaderConfig');\n        if (configElement) {\n            const config = JSON.parse(configElement.innerHTML);\n            if (config) {\n                this.$store.commit('init', config);\n            }\n        }\n        if (this.$store.state.callbacks && this.$store.state.callbacks.autoLoad) {\n            this.$store.state.callbacks.autoLoad((sourceData: string) => {\n                this.$store.dispatch('load', sourceData);\n            });\n        }\n        this.updateWindowSize();\n        window.addEventListener('resize', this.updateWindowSize);\n    }\n\n    public beforeDestroy() {\n        window.removeEventListener('resize', this.updateWindowSize);\n    }\n\n    public updateWindowSize() {\n        if (window.innerWidth < 1024) {\n            this.$store.commit('setMode', 'small');\n        } else {\n            this.$store.commit('setMode', 'large');\n        }\n    }\n}\n","import mod from \"-!../node_modules/cache-loader/dist/cjs.js??ref--14-0!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/ts-loader/index.js??ref--14-3!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../node_modules/cache-loader/dist/cjs.js??ref--14-0!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/ts-loader/index.js??ref--14-3!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./App.vue?vue&type=template&id=f747fe56&\"\nimport script from \"./App.vue?vue&type=script&lang=ts&\"\nexport * from \"./App.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./App.vue?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","function nsResolver(prefix: string | null) {\n    if (prefix === 'tei') {\n        return 'http://www.tei-c.org/ns/1.0';\n    } else if (prefix === 'xml') {\n        return 'http://www.w3.org/XML/1998/namespace';\n    } else {\n        return 'http://www.tei-c.org/ns/1.0';\n    }\n}\n\nexport default class XPathEvaluator {\n    private dom: XMLDocument;\n\n    constructor (dom: XMLDocument) {\n        this.dom = dom;\n    }\n\n    evaluate(node: Node, xpath: string, resultType: number) {\n        return this.dom.evaluate(xpath, node, nsResolver, resultType, null);\n    }\n\n    firstNode(node: Node, xpath: string) {\n        return this.evaluate(node, xpath, XPathResult.FIRST_ORDERED_NODE_TYPE).singleNodeValue;\n    }\n\n    nodeIterator(node: Node, xpath: string) {\n        return this.evaluate(node, xpath, XPathResult.ORDERED_NODE_ITERATOR_TYPE);\n    }\n\n    stringValue(node: Node, xpath: string) {\n        return this.evaluate(node, xpath, XPathResult.STRING_TYPE).stringValue;\n    }\n\n    booleanValue(node: Node, xpath: string) {\n        return this.evaluate(node, xpath, XPathResult.BOOLEAN_TYPE).booleanValue;\n    }\n\n    numberValue(node: Node, xpath: string) {\n        return this.evaluate(node, xpath, XPathResult.NUMBER_TYPE).numberValue;\n    }\n}\n","import XPathEvaluator from './XPathEvaluator';\nimport get from './get';\n\nexport default class TEIMetadataParser {\n    private dom: XMLDocument;\n    private xpath: XPathEvaluator;\n    private config: any;\n    private data: any;\n\n    constructor(dom: XMLDocument, config: any) {\n        this.dom = dom;\n        this.xpath = new XPathEvaluator(this.dom);\n        this.config = config;\n    }\n\n    public get() {\n        if (!this.data) {\n            const header = this.xpath.firstNode(this.dom.documentElement, '/tei:TEI/tei:teiHeader') as Element;\n            this.data = {};\n            for (let idx = 0; idx < this.config.schema.length; idx++) {\n                const temp = this.parseHeaderNode(header, this.config.schema[idx]);\n                if (temp) {\n                    this.data[this.config.schema[idx].tag.substring(4)] = temp;\n                }\n            }\n        }\n        return this.data;\n    }\n\n    private parseHeaderNode(node: Element, schema: any) {\n        const elements = this.xpath.nodeIterator(node, schema.tag);\n        const result = [] as any;\n        let element = elements.iterateNext() as Element;\n        while (element) {\n            const obj = {\n                _attrs: {},\n                _text: element.children.length === 0 ? this.xpath.stringValue(element, 'text()') : null\n            } as any;\n            for(let idx = 0; idx < element.attributes.length; idx++) {\n                obj._attrs[element.attributes[idx].name] = element.attributes[idx].value;\n            }\n            if (schema.children) {\n                for (let idx = 0; idx < schema.children.length; idx++) {\n                    const temp = this.parseHeaderNode(element, schema.children[idx]);\n                    if (temp) {\n                        obj[schema.children[idx].tag.substring(schema.children[idx].tag.indexOf(':') + 1)] = temp;\n                    }\n                }\n            }\n            result.push(obj);\n            element = elements.iterateNext() as Element;\n        }\n        if (result.length === 0) {\n            return null;\n        } else {\n            if (schema.multiple) {\n                return result;\n            } else {\n                return result[0];\n            }\n        }\n    }\n}\n","import XPathEvaluator from './XPathEvaluator';\nimport { SerialisedNode, NestedDocSet, SerialisedAttrs, ParseAttributesSchema, ParseParserSchema, TEITextParserConfig,\n    ParseNodeSchema, SerialisedNodeMark } from '@/interfaces';\n\nexport default class TEITextParser {\n    private dom: XMLDocument;\n    private xpath: XPathEvaluator;\n    private config: TEITextParserConfig;\n    private doc: SerialisedNode | null = null;\n    private nestedDocs: NestedDocSet = {} as NestedDocSet;\n\n    constructor(dom: XMLDocument, config: TEITextParserConfig) {\n        this.dom = dom;\n        this.xpath = new XPathEvaluator(this.dom);\n        this.config = config;\n    }\n\n    public get(): [SerialisedNode, NestedDocSet] {\n        if (!this.doc) {\n            this.doc = {\n                type: 'doc',\n                content: [],\n            };\n            this.nestedDocs = {};\n            if (this.config.parser && this.config.parser.selector) {\n                const node = this.xpath.firstNode(this.dom.documentElement, this.config.parser.selector) as Element;\n                if (node) {\n                    for(let idx = 0; idx < node.children.length; idx++) {\n                        const tmp = this.parseContentNode(node.children[idx], this.config);\n                        if (tmp && !tmp.nestedDoc && this.doc.content) {\n                            this.doc.content.push(tmp);\n                        } else if (tmp && tmp.nestedDoc) {\n                            this.addNestedDoc(tmp);\n                        }\n                    }\n                }\n            }\n        }\n        return [this.doc, this.nestedDocs];\n    }\n\n    private parseContentAttributes(node: Element, attrs: ParseAttributesSchema) {\n        // Parse attributes for nodes or marks. Attributes can have a type which is boolean, number, static, or string (default).\n        const result = {} as SerialisedAttrs;\n        Object.entries(attrs).forEach(([key, schema]) => {\n            let parsers = [] as ParseParserSchema[];\n            if (schema.parser) {\n                parsers.push(schema.parser);\n            } else if (schema.parsers) {\n                parsers = schema.parsers;\n            }\n            for (let idx = 0; idx < parsers.length; idx++) {\n                const parser = parsers[idx];\n                if (parser.type === 'boolean') {\n                    result[key] = this.xpath.booleanValue(node, parser.selector);\n                } else if (parser.type === 'number') {\n                    try {\n                        result[key] = this.xpath.numberValue(node, parser.selector);\n                    } catch(e) {\n                        // eslint-disable-next-line\n                        console.log(e);\n                    }\n                } else if (parser.type === 'static') {\n                    if (this.xpath.booleanValue(node, parser.selector)) {\n                        result[key] = parser.value;\n                    }\n                } else {\n                    try {\n                        const value = this.xpath.stringValue(node, parser.selector);\n                        if (value) {\n                            result[key] = value;\n                        }\n                    } catch(e) {\n                        // eslint-disable-next-line\n                        console.log(e);\n                    }\n                }\n            }\n        });\n        return result;\n    }\n\n    private parseContentMarks(node: Element, schema: ParseNodeSchema[]) {\n        // Parse the marks of a text node\n        const result = [] as SerialisedNodeMark[];\n        schema.forEach((entry: ParseNodeSchema) => {\n            if (entry.type === 'mark') {\n                let parsers = [] as ParseParserSchema[];\n                if (entry.parser) {\n                    parsers.push(entry.parser);\n                } else if (entry.parsers) {\n                    parsers = entry.parsers;\n                }\n                for (let idx = 0; idx < parsers.length; idx++) {\n                    if (this.xpath.booleanValue(node, parsers[idx].selector)) {\n                        const mark = {\n                            type: entry.name\n                        } as SerialisedNodeMark;\n                        if (entry.attrs) {\n                            mark.attrs = this.parseContentAttributes(node, entry.attrs);\n                        }\n                        result.push(mark);\n                    }\n                }\n            }\n        });\n        return result;\n    }\n\n    private parseContentNode(node: Element, section: TEITextParserConfig) {\n        // Parse a single content node\n        const entries = Object.entries(section.schema);\n        for (let idx = 0; idx < entries.length; idx++) {\n            //let key = entries[idx][0];\n            const nodeSchema = entries[idx][1] as ParseNodeSchema;\n            let parsers = [] as ParseParserSchema[];\n            if (nodeSchema.parser) {\n                parsers.push(nodeSchema.parser);\n            } else if (nodeSchema.parsers) {\n                parsers = parsers.concat(nodeSchema.parsers);\n            }\n            for (let idx2 = 0; idx2 < parsers.length; idx2++) {\n                const parser = parsers[idx2];\n                if (this.xpath.firstNode(node, 'self::' + parser.selector) !== null) {\n                    // The first schema node where the parser selector matches is chosen as the result\n                    const result = {\n                        type: nodeSchema.name\n                    } as SerialisedNode;\n                    if (nodeSchema.attrs) {\n                        result.attrs = this.parseContentAttributes(node, nodeSchema.attrs);\n                    }\n                    if (nodeSchema.type === 'nested') {\n                        result.nestedDoc = true;\n                    }\n                    if (nodeSchema.type === 'inline') {\n                        // Inline nodes are either loaded as text nodes with marks or as complex text nodes\n                        if (nodeSchema.name === 'text') {\n                            if (parser.text) {\n                                result.text = this.xpath.stringValue(node, parser.text);\n                            }\n                            result.marks = this.parseContentMarks(node, section.schema);\n                            if (node.children.length === 1) {\n                                const temp = this.parseContentNode(node.children[0], section);\n                                if (temp && temp.text && temp.text !== '') {\n                                    result.text = temp.text;\n                                }\n                                if (temp && temp.marks) {\n                                    result.marks = result.marks.concat(temp.marks);\n                                }\n                            }\n                        } else {\n                            if (node.children.length === 0) {\n                                // Inline nodes without children need a virtual text node added if they have text\n                                if (parser.text && this.xpath.stringValue(node, parser.text)) {\n                                    result.content = [\n                                        {\n                                            type: 'text',\n                                            text: this.xpath.stringValue(node, parser.text),\n                                            marks: this.parseContentMarks(node, section.schema)\n                                        }\n                                    ];\n                                }\n                            } else {\n                                const content = [];\n                                for (let idx3 = 0; idx3 < node.children.length; idx3++) {\n                                    const child = this.parseContentNode(node.children[idx3], section);\n                                    if (child) {\n                                        content.push(child);\n                                    }\n                                }\n                                result.content = content;\n                            }\n                        }\n                    } else {\n                        const content = [];\n                        for (let idx3 = 0; idx3 < node.children.length; idx3++) {\n                            const child = this.parseContentNode(node.children[idx3], section);\n                            if (child && !child.nestedDoc) {\n                                content.push(child);\n                            } else if (child && child.nestedDoc) {\n                                this.addNestedDoc(child);\n                            }\n                        }\n                        result.content = content;\n                    }\n                    return result;\n                }\n            }\n        }\n        return null;\n    }\n\n    private addNestedDoc(nestedParent: SerialisedNode) {\n        if (nestedParent.attrs && nestedParent.attrs.id) {\n            if (!this.nestedDocs[nestedParent.type]) {\n                this.nestedDocs[nestedParent.type] = {};\n            }\n            this.nestedDocs[nestedParent.type][nestedParent.attrs.id] = nestedParent;\n            const nestedDoc = {\n                type: 'doc',\n                content: nestedParent.content,\n            }\n            nestedParent.content = [nestedDoc];\n        }\n    }\n}\n","/**\n * Performs a deep cloning of the first element of the parameters.\n */\nexport default function deepclone(obj: any): any {\n    if (obj === undefined) {\n        return undefined;\n    } else if (obj === null) {\n        return null;\n    } else if (Array.isArray(obj)) {\n        return obj.map((val) => {\n            return deepclone(val);\n        });\n    } else if (typeof(obj) === 'object') {\n        const clone = {} as any;\n        Object.keys(obj).forEach(function(key) {\n            clone[key] = deepclone(obj[key]);\n        });\n        return clone;\n    } else {\n        return obj;\n    }\n}\n","import Vue from 'vue'\nimport Vuex from 'vuex'\n\nimport TEIMetadataParser from '@/util/TEIMetadataParser';\nimport TEITextParser from '@/util/TEITextParser';\nimport deepclone from '@/util/deepclone';\nimport { State, Config, MutationSetTextDoc, MutationToggleAnnotation, MutationSetMetadata, LoadActionParameters } from '@/interfaces';\n\nVue.use(Vuex)\n\nexport default new Vuex.Store({\n    state: {\n        content: {\n        },\n        callbacks: {\n        },\n        sections: {\n        },\n        ui: {\n            mode: 'small',\n            smallMenuOpen: false,\n            selectedSection: null,\n            sections: {},\n            closeLabel: null,\n            identifier: '',\n        }\n    } as State,\n    mutations: {\n        init(state, config: Config) {\n            state.sections = config.sections;\n            Object.keys(config.sections).forEach((key, idx) => {\n                Vue.set(state.content, key, {});\n                if (config.sections[key].type === 'Text') {\n                    Vue.set(state.content[key], 'doc', null);\n                    Vue.set(state.content[key], 'nested', {});\n                }\n\n                Vue.set(state.ui.sections, key, {});\n                if (config.sections[key].type === 'Text') {\n                    Vue.set(state.ui.sections[key], 'annotations', []);\n                    Vue.set(state.ui.sections[key], 'footnote', null);\n                }\n\n                if (idx === 0) {\n                    state.ui.selectedSection = key;\n                }\n            });\n            // eslint-disable-next-line\n            // @ts-ignore\n            if (window.TEIReader && window.TEIReader.callbacks) {\n                // eslint-disable-next-line\n                // @ts-ignore\n                Vue.set(state.callbacks, 'autoLoad', window.TEIReader.callbacks.autoLoad);\n                // eslint-disable-next-line\n                // @ts-ignore\n                Vue.set(state.callbacks, 'close', window.TEIReader.callbacks.close);\n            }\n            if (config.ui && config.ui.closeLabel) {\n                state.ui.closeLabel = config.ui.closeLabel;\n            }\n        },\n\n        setTextDoc(state, payload: MutationSetTextDoc) {\n            const path = payload.path.split('.');\n            if (path.length === 2) {\n                Vue.set(state.content[path[0]], path[1], payload.doc);\n            } else if(path.length === 4) {\n                Vue.set(state.content[path[0]].nested[path[2]][path[3]], 'content', [payload.doc]);\n            }\n        },\n\n        addNestedDoc(state, payload: MutationSetTextDoc) {\n            const path = payload.path.split('.');\n            if (path.length === 4) {\n                if (!state.content[path[0]].nested[path[2]]) {\n                    Vue.set(state.content[path[0]].nested, path[2], {});\n                }\n                Vue.set(state.content[path[0]].nested[path[2]], path[3], {\n                    attrs: {\n                        id: path[3],\n                    },\n                    content: [\n                        payload.doc,\n                    ],\n                    nestedDoc: true,\n                    type: path[2],\n                });\n            }\n        },\n\n        setMetadata(state, payload: MutationSetMetadata) {\n            Vue.set(state.content, payload.path, payload.metadata);\n        },\n\n        selectSection(state, section: string) {\n            state.ui.selectedSection = section;\n        },\n\n        toggleAnnotation(state, payload: MutationToggleAnnotation) {\n            const path = payload.path.split('.');\n            if (path.length === 4) {\n                const annotations = deepclone(state.ui.sections[path[0]].annotations);\n                if (annotations.indexOf(payload.path) >= 0) {\n                    annotations.splice(annotations.indexOf(payload.path), 1);\n                } else {\n                    annotations.push(payload.path);\n                }\n                Vue.set(state.ui.sections[path[0]], 'annotations', annotations);\n            }\n        },\n\n        toggleFootnote(state, payload: MutationToggleAnnotation) {\n            const path = payload.path.split('.');\n            if (path.length === 4) {\n                if (state.ui.sections[path[0]].footnote === payload.path) {\n                    Vue.set(state.ui.sections[path[0]], 'footnote', null);\n                } else {\n                    Vue.set(state.ui.sections[path[0]], 'footnote', payload.path);\n                }\n            }\n        },\n\n        toggleSmallMenu(state) {\n            state.ui.smallMenuOpen = !state.ui.smallMenuOpen;\n        },\n\n        setMode(state, payload: string) {\n            state.ui.mode = payload;\n        },\n\n        setDocIdentifier(state, payload: string) {\n            state.ui.identifier = payload;\n        },\n    },\n    actions: {\n        load({ commit, state }, newDoc: LoadActionParameters) {\n            commit('setDocIdentifier', newDoc.identifier);\n            const domParser = new DOMParser();\n            const dom = domParser.parseFromString(newDoc.content, 'application/xml');\n            Vue.set(state, 'content', {});\n            Object.keys(state.sections).forEach((key) => {\n                Vue.set(state.content, key, {});\n                Vue.set(state.content[key], 'doc', null);\n                Vue.set(state.content[key], 'nested', {});\n            });\n            Object.entries(state.sections).forEach(([key, config]) => {\n                if (config.type === 'Metadata') {\n                    commit('setMetadata', { path: key, metadata: (new TEIMetadataParser(dom, config)).get() });\n                } else if (config.type === 'Text') {\n                    const [doc, nestedDocs] = (new TEITextParser(dom, config)).get();\n                    commit('setTextDoc', { path: key + '.doc', doc: doc });\n                    Object.entries(nestedDocs).forEach(([nestedKey, docs]) => {\n                        Object.entries(docs).forEach(([docKey, doc]) => {\n                            if (doc.content) {\n                                commit('addNestedDoc', {path: key + '.nested.' + nestedKey + '.' + docKey, doc: doc.content[0]});\n                            }\n                        });\n                    });\n                }\n            });\n        }\n    },\n    modules: {\n    }\n})\n","import Vue from 'vue';\nimport App from './App.vue';\nimport store from './store';\n// eslint-disable-next-line\n// @ts-ignore\nimport vuescroll from 'vue-scroll';\n\nVue.use(vuescroll, { debounce: 50 });\n\nVue.config.productionTip = false\n\nnew Vue({\n  store,\n  render: h => h(App)\n}).$mount('#app')\n"],"sourceRoot":""}